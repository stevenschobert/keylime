(function(){var _;(function(){function T(a){return typeof a.toString!="function"&&typeof(a+"")=="string"}function U(a){a.length=0;F.length<Ga&&F.push(a)}function v(a,b,d){b||(b=0);typeof d=="undefined"&&(d=a?a.length:0);var c=-1;d=d-b||0;for(var f=Array(0>d?0:d);++c<d;)f[c]=a[b+c];return f}function e(){}function Ha(a){function b(){if(c){var a=v(c);V.apply(a,arguments)}if(this instanceof b){var h=ba(d.prototype),a=d.apply(h,a||arguments);return w(a)?a:h}return d.apply(f,a||arguments)}var d=a[0],c=a[2],f=a[4];ca(b,a);return b}function pa(a,b,d,c,f){if(d){var g=d(a);if(typeof g!="undefined")return g}if(w(a)){var h=q.call(a);if(!x[h]||!l.nodeClass&&T(a))return a;var W=y[h];switch(h){case L:case M:return new W(+a);case N:case C:return new W(a);case O:return g=W(a.source,Ia.exec(a)),g.lastIndex=a.lastIndex,g}}else return a;h=G(a);if(b){var e=!c;c||(c=F.pop()||[]);f||(f=F.pop()||[]);for(var p=c.length;p--;)if(c[p]==a)return f[p];g=h?W(a.length):{}}else g=h?v(a):da({},a);h&&(r.call(a,"index")&&(g.index=a.index),r.call(a,"input")&&(g.input=a.input));if(!b)return g;c.push(a);f.push(g);(h?ea:qa)(a,function(a,h){g[h]=pa(a,b,d,c,f)});e&&(U(c),U(f));return g}function ba(a,b){return w(a)?X(a):{}}function fa(a,b,d){if(typeof a!="function")return ra;if(typeof b=="undefined"||!("prototype"in a))return a;var c=a.__bindData__;if(typeof c=="undefined"&&(l.funcNames&&(c=!a.name),c=c||!l.funcDecomp,!c)){var f=Ja.call(a);l.funcNames||(c=!Ka.test(f));c||(c=sa.test(f),ca(a,c))}if(false===c||true!==c&&c[1]&1)return a;switch(d){case 1:return function(c){return a.call(b,c)};case 2:return function(c,d){return a.call(b,c,d)};case 3:return function(c,d,f){return a.call(b,c,d,f)};case 4:return function(c,d,f,e){return a.call(b,c,d,f,e)}}return ta(a,b)}function ua(a){function b(){var a=l?h:this;if(f){var s=v(f);V.apply(s,arguments)}if(g||m)if(s||(s=v(arguments)),g&&V.apply(s,g),m&&s.length<e)return c|=16,ua([d,n?c:c&-4,s,null,h,e]);s||(s=arguments);p&&(d=a[q]);return this instanceof b?(a=ba(d.prototype),s=d.apply(a,s),w(s)?s:a):d.apply(a,s)}var d=a[0],c=a[1],f=a[2],g=a[3],h=a[4],e=a[5],l=c&1,p=c&2,m=c&4,n=c&8,q=d;ca(b,a);return b}function ga(a,b,d,c){c=(c||0)-1;for(var f=a?a.length:0,g=[];++c<f;){var h=a[c];if(h&&typeof h=="object"&&typeof h.length=="number"&&(G(h)||A(h))){b||(h=ga(h,b,d));var e=-1,l=h.length,p=g.length;for(g.length+=l;++e<l;)g[p++]=h[e]}else d||g.push(h)}return g}function P(a,b,d,c,f,g){if(d){var h=d(a,b);if(typeof h!="undefined")return!!h}if(a===b)return 0!==a||1/a==1/b;if(a===a&&!(a&&H[typeof a]||b&&H[typeof b]))return false;if(null==a||null==b)return a===b;var e=q.call(a),z=q.call(b);e==Q&&(e=B);z==Q&&(z=B);if(e!=z)return false;switch(e){case L:case M:return+a==+b;case N:return a!=+a?b!=+b:0==a?1/a==1/b:a==+b;case O:case C:return a==String(b)}z=e==R;if(!z){var p=r.call(a,"__wrapped__"),m=r.call(b,"__wrapped__");if(p||m)return P(p?a.__wrapped__:a,m?b.__wrapped__:b,d,c,f,g);if(e!=B||!l.nodeClass&&(T(a)||T(b)))return false;e=!l.argsObject&&A(a)?Object:a.constructor;p=!l.argsObject&&A(b)?Object:b.constructor;if(e!=p&&!(D(e)&&e instanceof e&&D(p)&&p instanceof p)&&"constructor"in a&&"constructor"in b)return false}e=!f;f||(f=F.pop()||[]);g||(g=F.pop()||[]);for(p=f.length;p--;)if(f[p]==a)return g[p]==b;var n=0,h=true;f.push(a);g.push(b);if(z){if(p=a.length,n=b.length,(h=n==p)||c)for(;n--;)if(z=p,m=b[n],c)for(;z--&&!(h=P(a[z],m,d,c,f,g)););else if(!(h=P(a[n],m,d,c,f,g)))break}else I(b,function(b,e,l){if(r.call(l,e))return n++,h=r.call(a,e)&&P(a[e],b,d,c,f,g)}),h&&!c&&I(a,function(a,b,c){if(r.call(c,b))return h=-1<--n});f.pop();g.pop();e&&(U(f),U(g));return h}function ha(a,b,d,c,f,e){var h=b&1,l=b&4,n=b&16,p=b&32;if(!(b&2||D(a)))throw new TypeError;n&&!d.length&&(b&=-17,n=d=false);p&&!c.length&&(b&=-33,p=c=false);var m=a&&a.__bindData__;return m&&true!==m?(m=v(m),m[2]&&(m[2]=v(m[2])),m[3]&&(m[3]=v(m[3])),!h||m[1]&1||(m[4]=f),!h&&m[1]&1&&(b|=8),!l||m[1]&4||(m[5]=e),n&&V.apply(m[2]||(m[2]=[]),d),p&&La.apply(m[3]||(m[3]=[]),c),m[1]|=b,ha.apply(null,m)):(1==b||17===b?Ha:ua)([a,b,d,c,f,e])}function S(){u.h=ia;u.b=u.c=u.g=u.i="";u.e="t";u.j=true;for(var a,b=0;a=arguments[b];b++)for(var d in a)u[d]=a[d];b=u.a;u.d=/^[^,]+/.exec(b)[0];a=Function;b="return function("+b+"){";d=u;var c="var n,t="+d.d+",E="+d.e+";if(!t)return E;"+d.i+";";d.b?(c+="var u=t.length;n=-1;if("+d.b+"){",l.unindexedChars&&(c+="if(s(t)){t=t.split('')}"),c+="while(++n<u){"+d.g+";}}else{"):l.nonEnumArgs&&(c+="var u=t.length;n=-1;if(u&&p(t)){while(++n<u){n+='';"+d.g+";}}else{");l.enumPrototypes&&(c+="var G=typeof t=='function';");l.enumErrorProps&&(c+="var F=t===k||t instanceof Error;");var f=[];l.enumPrototypes&&f.push('!(G&&n=="prototype")');l.enumErrorProps&&f.push('!(F&&(n=="message"||n=="name"))');if(d.j&&d.f)c+="var C=-1,D=B[typeof t]&&v(t),u=D?D.length:0;while(++C<u){n=D[C];",f.length&&(c+="if("+f.join("&&")+"){"),c+=d.g+";",f.length&&(c+="}"),c+="}";else if(c+="for(n in t){",d.j&&f.push("m.call(t, n)"),f.length&&(c+="if("+f.join("&&")+"){"),c+=d.g+";",f.length&&(c+="}"),c+="}",l.nonEnumShadows){c+="if(t!==A){var i=t.constructor,r=t===(i&&i.prototype),f=t===J?I:t===k?j:L.call(t),x=y[f];";for(k=0;7>k;k++)c+="n='"+d.h[k]+"';if((!(r&&x[n])&&m.call(t,n))",d.j||(c+="||(!x[n]&&t[n]!==A[n])"),c+="){"+d.g+"}";c+="}"}if(d.b||l.nonEnumArgs)c+="}";c+=d.c+";return E";return a("d,j,k,m,o,p,q,s,v,A,B,y,I,J,L",b+c+"}")(fa,va,ja,r,Ma,A,G,wa,u.f,Y,H,n,C,Na,q)}function E(a){return typeof a=="function"&&Oa.test(a)}function xa(a){var b,d;if(!a||q.call(a)!=B||(b=a.constructor,D(b)&&!(b instanceof b))||!l.argsClass&&A(a)||!l.nodeClass&&T(a))return false;if(l.ownLast)return I(a,function(a,b,e){d=r.call(e,b);return false}),false!==d;I(a,function(a,b){d=b});return typeof d=="undefined"||r.call(a,d)}function A(a){return a&&typeof a=="object"&&typeof a.length=="number"&&q.call(a)==Q||false}function D(a){return typeof a=="function"}function w(a){return!(!a||!H[typeof a])}function wa(a){return typeof a=="string"||a&&typeof a=="object"&&q.call(a)==C||false}function ya(a,b,d){if(b&&typeof d=="undefined"&&G(a)){d=-1;for(var c=a.length;++d<c&&false!==b(a[d],d,a););}else ea(a,b,d);return a}function ka(a,b,d){var c=-1,f=a?a.length:0,g=Array(typeof f=="number"?f:0);b=e.createCallback(b,d,3);if(G(a))for(;++c<f;)g[c]=b(a[c],c,a);else ea(a,function(a,d,e){g[++c]=b(a,d,e)});return g}function la(a,b,d){var c=0,f=a?a.length:0;if(typeof b!="number"&&null!=b){var g=-1;for(b=e.createCallback(b,d,3);++g<f&&b(a[g],g,a);)c++}else if(c=b,null==c||d)return a?a[0]:Pa;return v(a,0,Qa(za(0,c),f))}function ma(a,b,d){if(typeof b!="number"&&null!=b){var c=0,f=-1,g=a?a.length:0;for(b=e.createCallback(b,d,3);++f<g&&b(a[f],f,a);)c++}else c=null==b||d?1:za(0,b);return v(a,c)}function ta(a,b){return 2<arguments.length?ha(a,17,v(arguments,2),null,b):ha(a,1,null,null,b)}function ra(a){return a}function Aa(){}function Ba(a){return function(b){return b[a]}}var Pa,F=[],Ma={},Ga=40,Ia=/\w*$/,Ka=/^\s*function[ \n\r\t]+\w/,sa=/\bthis\b/,ia="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" "),Q="[object Arguments]",R="[object Array]",L="[object Boolean]",M="[object Date]",va="[object Error]",N="[object Number]",B="[object Object]",O="[object RegExp]",C="[object String]",x={"[object Function]":false};x[Q]=x[R]=x[L]=x[M]=x[N]=x[B]=x[O]=x[C]=true;var Ca={configurable:false,enumerable:false,value:null,writable:false},u={a:"",b:null,c:"",d:"",e:"",v:null,g:"",h:null,support:null,i:"",j:false},H={"boolean":false,"function":true,object:true,number:false,string:false,undefined:false},na=H[typeof window]&&window||this,t=H[typeof global]&&global;!t||t.global!==t&&t.window!==t||(na=t);var oa=[],ja=Error.prototype,Y=Object.prototype,Na=String.prototype,q=Y.toString,Oa=RegExp("^"+String(q).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$"),Ja=Function.prototype.toString,J=E(J=Object.getPrototypeOf)&&J,r=Y.hasOwnProperty,V=oa.push,Z=Y.propertyIsEnumerable,La=oa.unshift,Da=function(){try{var a={},b=E(b=Object.defineProperty)&&b,d=b(a,a,a)&&b}catch(c){}return d}(),X=E(X=Object.create)&&X,K=E(K=Array.isArray)&&K,$=E($=Object.keys)&&$,za=Math.max,Qa=Math.min,y={};y[R]=Array;y[L]=Boolean;y[M]=Date;y["[object Function]"]=Function;y[B]=Object;y[N]=Number;y[O]=RegExp;y[C]=String;var n={};n[R]=n[M]=n[N]={constructor:true,toLocaleString:true,toString:true,valueOf:true};n[L]=n[C]={constructor:true,toString:true,valueOf:true};n[va]=n["[object Function]"]=n[O]={constructor:true,toString:true};n[B]={constructor:true};(function(){for(var a=ia.length;a--;){var b=ia[a],d;for(d in n)r.call(n,d)&&!r.call(n[d],b)&&(n[d][b]=false)}})();var l=e.support={};(function(){var a=function(){this.x=1},b={0:1,length:1},d=[];a.prototype={valueOf:1,y:1};for(var c in new a)d.push(c);for(c in arguments);l.argsClass=q.call(arguments)==Q;l.argsObject=arguments.constructor==Object&&!(arguments instanceof Array);l.enumErrorProps=Z.call(ja,"message")||Z.call(ja,"name");l.enumPrototypes=Z.call(a,"prototype");l.funcDecomp=!E(na.WinRTError)&&sa.test(function(){return this});l.funcNames=typeof Function.name=="string";l.nonEnumArgs=0!=c;l.nonEnumShadows=!/valueOf/.test(d);l.ownLast="x"!=d[0];l.spliceObjects=(oa.splice.call(b,0,1),!b[0]);l.unindexedChars="xx"!="x"[0]+Object("x")[0];try{l.nodeClass=!(q.call(document)==B&&!({toString:0}+""))}catch(e){l.nodeClass=true}})(1);X||(ba=function(){function a(){}return function(b){if(w(b)){a.prototype=b;var d=new a;a.prototype=null}return d||na.Object()}}());var ca=Da?function(a,b){Ca.value=b;Da(a,"__bindData__",Ca)}:Aa;l.argsClass||(A=function(a){return a&&typeof a=="object"&&typeof a.length=="number"&&r.call(a,"callee")&&!Z.call(a,"callee")||false});var G=K||function(a){return a&&typeof a=="object"&&typeof a.length=="number"&&q.call(a)==R||false},Ea=S({a:"z",e:"[]",i:"if(!(B[typeof z]))return E",g:"E.push(n)"}),aa=$?function(a){return w(a)?l.enumPrototypes&&typeof a=="function"||l.nonEnumArgs&&a.length&&A(a)?Ea(a):$(a):[]}:Ea,t={a:"g,e,K",i:"e=e&&typeof K=='undefined'?e:d(e,K,3)",b:"typeof u=='number'",v:aa,g:"if(e(t[n],n,g)===false)return E"},K={a:"z,H,l",i:"var a=arguments,b=0,c=typeof l=='number'?2:a.length;while(++b<c){t=a[b];if(t&&B[typeof t]){",v:aa,g:"if(typeof E[n]=='undefined')E[n]=t[n]",c:"}}"},Fa={i:"if(!B[typeof t])return E;"+t.i,b:false},ea=S(t),da=S(K,{i:K.i.replace(";",";if(c>3&&typeof a[c-2]=='function'){var e=d(a[--c-1],a[c--],2)}else if(c>2&&typeof a[c-1]=='function'){e=a[--c]}"),g:"E[n]=e?e(E[n],t[n]):t[n]"}),I=S(t,Fa,{j:false}),qa=S(t,Fa);D(/x/)&&(D=function(a){return typeof a=="function"&&"[object Function]"==q.call(a)});t=J?function(a){if(!a||q.call(a)!=B||!l.argsClass&&A(a))return false;var b=a.valueOf,d=E(b)&&(d=J(b))&&J(d);return d?a==d||J(a)==d:xa(a)}:xa;e.assign=da;e.bind=ta;e.createCallback=function(a,b,d){var c=typeof a;if(null==a||"function"==c)return fa(a,b,d);if("object"!=c)return Ba(a);var e=aa(a),g=e[0],h=a[g];return 1!=e.length||h!==h||w(h)?function(b){for(var c=e.length,d=false;c--&&(d=P(b[e[c]],a[e[c]],null,true)););return d}:function(a){a=a[g];return h===a&&(0!==h||1/h==1/a)}};e.flatten=function(a,b,d,c){typeof b!="boolean"&&null!=b&&(c=d,d=typeof b!="function"&&c&&c[b]===a?null:b,b=false);null!=d&&(a=ka(a,d,c));return ga(a,b)};e.forEach=ya;e.forIn=I;e.forOwn=qa;e.keys=aa;e.map=ka;e.pick=function(a,b,d){var c={};if(typeof b!="function")for(var f=-1,g=ga(arguments,true,false,1),h=w(a)?g.length:0;++f<h;){var l=g[f];l in a&&(c[l]=a[l])}else b=e.createCallback(b,d,3),I(a,function(a,d,e){b(a,d,e)&&(c[d]=a)});return c};e.property=Ba;e.rest=ma;e.collect=ka;e.drop=ma;e.each=ya;e.extend=da;e.tail=ma;e.cloneDeep=function(a,b,d){return pa(a,true,typeof b=="function"&&fa(b,d,1))};e.identity=ra;e.isArguments=A;e.isArray=G;e.isFunction=D;e.isNull=function(a){return null===a};e.isObject=w;e.isPlainObject=t;e.isString=wa;e.isUndefined=function(a){return typeof a=="undefined"};e.noop=Aa;e.first=la;e.take=la;e.head=la;e.VERSION="2.4.1";_=e})();function keylime(name){var constructor;if(!_.isString(name)){throw new Error("You must supply a 'name' parameter to the Keylime function")}constructor=eval("function "+name+"(){var topArgs = arguments; var OriginalClass = "+name+"; var create"+name+" = function create"+name+"() { function "+name+"() { return OriginalClass.apply(this, topArgs); }; "+name+".prototype = OriginalClass.prototype; return new "+name+"(); }; if (!(this instanceof "+name+")) { return create"+name+"(); }; if (!this._model) {Object.defineProperties(this, {_model: {value: "+name+"}});}Object.getPrototypeOf("+name+".prototype).constructor.apply(this, arguments);};"+name);constructor._parent={constructor:null};constructor._blueprint={};constructor._lastAttr=null;constructor._initHandlers=[];constructor.attr=attr.bind(constructor);constructor.attrs=attrs.bind(constructor);constructor.inherits=constructor.inherit=inherits.bind(constructor);constructor.use=use.bind(constructor);constructor.method=method.bind(constructor);constructor.attrHelper=attrHelper.bind(constructor);constructor.init=init.bind(constructor);constructor.create=create.bind(constructor);constructor.prototype.__proto__=KeylimeModel.prototype;return constructor}function attr(name,value){if(!_.isString(name)){throw new Error("You must supply a 'name' argument to create an attribute on "+this.name+".")}if(_.isUndefined(value)){value=null}else if(_.isArray(value)||_.isPlainObject(value)){value=_.cloneDeep(value)}this._blueprint[name]={value:value};this._lastAttr=name;return this}function inherits(constructor){if(!_.isFunction(constructor)){throw new Error("You must supply a 'constructor' function argument to add inheritance on "+this.name+".")}if(!_isKeylimeConstructor(constructor)){throw new Error("You must supply another Keylime constructor to add inheritance on "+this.name+".")}this.prototype.__proto__=constructor.prototype;this._parent.constructor=constructor;return this}function KeylimeModel(values){recursiveApplyBlueprint.call(this,this._model,values);recursiveCallHandlers.apply(this,_.flatten([this._model,arguments]))}function recursiveCallHandlers(){var constructor=_.first(arguments),args=_.rest(arguments,1);if(!_.isNull(constructor._parent.constructor)){recursiveCallHandlers.apply(this,_.flatten([constructor._parent.constructor,args]))}_.each(constructor._initHandlers,function(handler){handler.apply(this,args)},this)}function recursiveApplyBlueprint(constructor,values){if(!_.isNull(constructor._parent.constructor)){recursiveApplyBlueprint.call(this,constructor._parent.constructor,values)}_.forIn(constructor._blueprint,function(value,key){if(_.isArray(value.value)||_.isPlainObject(value.value)){this[key]=_.cloneDeep(value.value)}else if(_.isFunction(value.value)){this[key]=value.value()}else{this[key]=value.value}},this);_.forIn(_.pick(values,_.keys(constructor._blueprint)),function(value,key){if(_.isArray(value)||_.isPlainObject(value)){this[key]=_.cloneDeep(value)}else if(_.isFunction(value)){this[key]=value()}else{this[key]=value}},this)}function use(func){if(!_.isFunction(func)){throw new Error("You must supply a function argument to call the 'use' method on "+this.name+".")}func(this);return this}function create(){return this.apply(null,arguments)}function method(name,func){if(!_.isString(name)){throw new Error("You must supply a 'name' argument to add a method on "+this.name+".")}if(!_.isFunction(func)){throw new Error("You must supply a function argument to add a method on "+this.name+".")}this.prototype[name]=func;return this}function attrHelper(name,func){if(!_.isString(name)){throw new Error("You must supply a 'name' argument to add an attribute helper on "+this.name+".")}if(!_.isFunction(func)){throw new Error("You must supply a function argument to add an attribute helper on "+this.name+".")}this[name]=function attrHelperProduct(){var lastAttribute;if(_.isNull(this._lastAttr)){throw new Error("You must add an attribute on "+this.name+" before you can use the "+name+" helper.")}lastAttribute=this._blueprint[this._lastAttr];func.apply(func,_.flatten([lastAttribute,[].slice.call(arguments)]));return this}.bind(this);return this}function attrs(name){if(_.isString(name)){return this._blueprint[name]}return this._blueprint}function init(handler){if(!_.isFunction(handler)){throw new Error("You must supply a function to add an initialization handler on "+this.name+".")}this._initHandlers.push(handler);return this}function _isKeylimeConstructor(constructor){if(!_.isFunction(constructor)){return false}if(!_.isPlainObject(constructor._blueprint)){return false}return true}(function(root,factory){if(typeof define==="function"&&define.amd){define([],factory)}else{root.keylime=factory()}})(this,function(){return keylime})})();