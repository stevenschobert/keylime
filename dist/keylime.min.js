(function(){var _;(function(){function T(a){return typeof a.toString!="function"&&typeof(a+"")=="string"}function U(a){a.length=0;F.length<Ga&&F.push(a)}function v(a,b,d){b||(b=0);typeof d=="undefined"&&(d=a?a.length:0);var c=-1;d=d-b||0;for(var f=Array(0>d?0:d);++c<d;)f[c]=a[b+c];return f}function e(){}function Ha(a){function b(){if(c){var a=v(c);V.apply(a,arguments)}if(this instanceof b){var h=ba(d.prototype),a=d.apply(h,a||arguments);return B(a)?a:h}return d.apply(f,a||arguments)}var d=a[0],c=a[2],f=a[4];ca(b,a);return b}function oa(a,b,d,c,f){if(d){var g=d(a);if(typeof g!="undefined")return g}if(B(a)){var h=r.call(a);if(!w[h]||!l.nodeClass&&T(a))return a;var W=x[h];switch(h){case K:case L:return new W(+a);case M:case C:return new W(a);case N:return g=W(a.source,Ia.exec(a)),g.lastIndex=a.lastIndex,g}}else return a;h=G(a);if(b){var e=!c;c||(c=F.pop()||[]);f||(f=F.pop()||[]);for(var p=c.length;p--;)if(c[p]==a)return f[p];g=h?W(a.length):{}}else g=h?v(a):da({},a);h&&(q.call(a,"index")&&(g.index=a.index),q.call(a,"input")&&(g.input=a.input));if(!b)return g;c.push(a);f.push(g);(h?ea:pa)(a,function(a,h){g[h]=oa(a,b,d,c,f)});e&&(U(c),U(f));return g}function ba(a,b){return B(a)?X(a):{}}function fa(a,b,d){if(typeof a!="function")return qa;if(typeof b=="undefined"||!("prototype"in a))return a;var c=a.__bindData__;if(typeof c=="undefined"&&(l.funcNames&&(c=!a.name),c=c||!l.funcDecomp,!c)){var f=Ja.call(a);l.funcNames||(c=!Ka.test(f));c||(c=ra.test(f),ca(a,c))}if(false===c||true!==c&&c[1]&1)return a;switch(d){case 1:return function(c){return a.call(b,c)};case 2:return function(c,d){return a.call(b,c,d)};case 3:return function(c,d,f){return a.call(b,c,d,f)};case 4:return function(c,d,f,e){return a.call(b,c,d,f,e)}}return sa(a,b)}function ta(a){function b(){var a=l?h:this;if(f){var s=v(f);V.apply(s,arguments)}if(g||m)if(s||(s=v(arguments)),g&&V.apply(s,g),m&&s.length<e)return c|=16,ta([d,q?c:c&-4,s,null,h,e]);s||(s=arguments);p&&(d=a[n]);return this instanceof b?(a=ba(d.prototype),s=d.apply(a,s),B(s)?s:a):d.apply(a,s)}var d=a[0],c=a[1],f=a[2],g=a[3],h=a[4],e=a[5],l=c&1,p=c&2,m=c&4,q=c&8,n=d;ca(b,a);return b}function ua(a,b,d,c){c=(c||0)-1;for(var f=a?a.length:0,g=[];++c<f;){var h=a[c];if(h&&typeof h=="object"&&typeof h.length=="number"&&(G(h)||z(h))){b||(h=ua(h,b,d));var e=-1,l=h.length,p=g.length;for(g.length+=l;++e<l;)g[p++]=h[e]}else d||g.push(h)}return g}function O(a,b,d,c,f,g){if(d){var h=d(a,b);if(typeof h!="undefined")return!!h}if(a===b)return 0!==a||1/a==1/b;if(a===a&&!(a&&H[typeof a]||b&&H[typeof b]))return false;if(null==a||null==b)return a===b;var e=r.call(a),y=r.call(b);e==P&&(e=A);y==P&&(y=A);if(e!=y)return false;switch(e){case K:case L:return+a==+b;case M:return a!=+a?b!=+b:0==a?1/a==1/b:a==+b;case N:case C:return a==String(b)}y=e==Q;if(!y){var p=q.call(a,"__wrapped__"),m=q.call(b,"__wrapped__");if(p||m)return O(p?a.__wrapped__:a,m?b.__wrapped__:b,d,c,f,g);if(e!=A||!l.nodeClass&&(T(a)||T(b)))return false;e=!l.argsObject&&z(a)?Object:a.constructor;p=!l.argsObject&&z(b)?Object:b.constructor;if(e!=p&&!(D(e)&&e instanceof e&&D(p)&&p instanceof p)&&"constructor"in a&&"constructor"in b)return false}e=!f;f||(f=F.pop()||[]);g||(g=F.pop()||[]);for(p=f.length;p--;)if(f[p]==a)return g[p]==b;var n=0,h=true;f.push(a);g.push(b);if(y){if(p=a.length,n=b.length,(h=n==p)||c)for(;n--;)if(y=p,m=b[n],c)for(;y--&&!(h=O(a[y],m,d,c,f,g)););else if(!(h=O(a[n],m,d,c,f,g)))break}else R(b,function(b,e,l){if(q.call(l,e))return n++,h=q.call(a,e)&&O(a[e],b,d,c,f,g)}),h&&!c&&R(a,function(a,b,c){if(q.call(c,b))return h=-1<--n});f.pop();g.pop();e&&(U(f),U(g));return h}function ga(a,b,d,c,f,e){var h=b&1,l=b&4,n=b&16,p=b&32;if(!(b&2||D(a)))throw new TypeError;n&&!d.length&&(b&=-17,n=d=false);p&&!c.length&&(b&=-33,p=c=false);var m=a&&a.__bindData__;return m&&true!==m?(m=v(m),m[2]&&(m[2]=v(m[2])),m[3]&&(m[3]=v(m[3])),!h||m[1]&1||(m[4]=f),!h&&m[1]&1&&(b|=8),!l||m[1]&4||(m[5]=e),n&&V.apply(m[2]||(m[2]=[]),d),p&&La.apply(m[3]||(m[3]=[]),c),m[1]|=b,ga.apply(null,m)):(1==b||17===b?Ha:ta)([a,b,d,c,f,e])}function S(){u.h=ha;u.b=u.c=u.g=u.i="";u.e="t";u.j=true;for(var a,b=0;a=arguments[b];b++)for(var d in a)u[d]=a[d];b=u.a;u.d=/^[^,]+/.exec(b)[0];a=Function;b="return function("+b+"){";d=u;var c="var n,t="+d.d+",E="+d.e+";if(!t)return E;"+d.i+";";d.b?(c+="var u=t.length;n=-1;if("+d.b+"){",l.unindexedChars&&(c+="if(s(t)){t=t.split('')}"),c+="while(++n<u){"+d.g+";}}else{"):l.nonEnumArgs&&(c+="var u=t.length;n=-1;if(u&&p(t)){while(++n<u){n+='';"+d.g+";}}else{");l.enumPrototypes&&(c+="var G=typeof t=='function';");l.enumErrorProps&&(c+="var F=t===k||t instanceof Error;");var f=[];l.enumPrototypes&&f.push('!(G&&n=="prototype")');l.enumErrorProps&&f.push('!(F&&(n=="message"||n=="name"))');if(d.j&&d.f)c+="var C=-1,D=B[typeof t]&&v(t),u=D?D.length:0;while(++C<u){n=D[C];",f.length&&(c+="if("+f.join("&&")+"){"),c+=d.g+";",f.length&&(c+="}"),c+="}";else if(c+="for(n in t){",d.j&&f.push("m.call(t, n)"),f.length&&(c+="if("+f.join("&&")+"){"),c+=d.g+";",f.length&&(c+="}"),c+="}",l.nonEnumShadows){c+="if(t!==A){var i=t.constructor,r=t===(i&&i.prototype),f=t===J?I:t===k?j:L.call(t),x=y[f];";for(k=0;7>k;k++)c+="n='"+d.h[k]+"';if((!(r&&x[n])&&m.call(t,n))",d.j||(c+="||(!x[n]&&t[n]!==A[n])"),c+="){"+d.g+"}";c+="}"}if(d.b||l.nonEnumArgs)c+="}";c+=d.c+";return E";return a("d,j,k,m,o,p,q,s,v,A,B,y,I,J,L",b+c+"}")(fa,va,ia,q,Ma,z,G,wa,u.f,Y,H,n,C,Na,r)}function E(a){return typeof a=="function"&&Oa.test(a)}function xa(a){var b,d;if(!a||r.call(a)!=A||(b=a.constructor,D(b)&&!(b instanceof b))||!l.argsClass&&z(a)||!l.nodeClass&&T(a))return false;if(l.ownLast)return R(a,function(a,b,e){d=q.call(e,b);return false}),false!==d;R(a,function(a,b){d=b});return typeof d=="undefined"||q.call(a,d)}function z(a){return a&&typeof a=="object"&&typeof a.length=="number"&&r.call(a)==P||false}function D(a){return typeof a=="function"}function B(a){return!(!a||!H[typeof a])}function wa(a){return typeof a=="string"||a&&typeof a=="object"&&r.call(a)==C||false}function ya(a,b,d){if(b&&typeof d=="undefined"&&G(a)){d=-1;for(var c=a.length;++d<c&&false!==b(a[d],d,a););}else ea(a,b,d);return a}function ja(a,b,d){var c=-1,f=a?a.length:0,g=Array(typeof f=="number"?f:0);b=e.createCallback(b,d,3);if(G(a))for(;++c<f;)g[c]=b(a[c],c,a);else ea(a,function(a,d,e){g[++c]=b(a,d,e)});return g}function ka(a,b,d){var c=0,f=a?a.length:0;if(typeof b!="number"&&null!=b){var g=-1;for(b=e.createCallback(b,d,3);++g<f&&b(a[g],g,a);)c++}else if(c=b,null==c||d)return a?a[0]:Pa;return v(a,0,Qa(za(0,c),f))}function la(a,b,d){if(typeof b!="number"&&null!=b){var c=0,f=-1,g=a?a.length:0;for(b=e.createCallback(b,d,3);++f<g&&b(a[f],f,a);)c++}else c=null==b||d?1:za(0,b);return v(a,c)}function sa(a,b){return 2<arguments.length?ga(a,17,v(arguments,2),null,b):ga(a,1,null,null,b)}function qa(a){return a}function Aa(){}function Ba(a){return function(b){return b[a]}}var Pa,F=[],Ma={},Ga=40,Ia=/\w*$/,Ka=/^\s*function[ \n\r\t]+\w/,ra=/\bthis\b/,ha="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" "),P="[object Arguments]",Q="[object Array]",K="[object Boolean]",L="[object Date]",va="[object Error]",M="[object Number]",A="[object Object]",N="[object RegExp]",C="[object String]",w={"[object Function]":false};w[P]=w[Q]=w[K]=w[L]=w[M]=w[A]=w[N]=w[C]=true;var Ca={configurable:false,enumerable:false,value:null,writable:false},u={a:"",b:null,c:"",d:"",e:"",v:null,g:"",h:null,support:null,i:"",j:false},H={"boolean":false,"function":true,object:true,number:false,string:false,undefined:false},ma=H[typeof window]&&window||this,t=H[typeof global]&&global;!t||t.global!==t&&t.window!==t||(ma=t);var na=[],ia=Error.prototype,Y=Object.prototype,Na=String.prototype,r=Y.toString,Oa=RegExp("^"+String(r).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$"),Ja=Function.prototype.toString,I=E(I=Object.getPrototypeOf)&&I,q=Y.hasOwnProperty,V=na.push,Z=Y.propertyIsEnumerable,La=na.unshift,Da=function(){try{var a={},b=E(b=Object.defineProperty)&&b,d=b(a,a,a)&&b}catch(c){}return d}(),X=E(X=Object.create)&&X,J=E(J=Array.isArray)&&J,$=E($=Object.keys)&&$,za=Math.max,Qa=Math.min,x={};x[Q]=Array;x[K]=Boolean;x[L]=Date;x["[object Function]"]=Function;x[A]=Object;x[M]=Number;x[N]=RegExp;x[C]=String;var n={};n[Q]=n[L]=n[M]={constructor:true,toLocaleString:true,toString:true,valueOf:true};n[K]=n[C]={constructor:true,toString:true,valueOf:true};n[va]=n["[object Function]"]=n[N]={constructor:true,toString:true};n[A]={constructor:true};(function(){for(var a=ha.length;a--;){var b=ha[a],d;for(d in n)q.call(n,d)&&!q.call(n[d],b)&&(n[d][b]=false)}})();var l=e.support={};(function(){var a=function(){this.x=1},b={0:1,length:1},d=[];a.prototype={valueOf:1,y:1};for(var c in new a)d.push(c);for(c in arguments);l.argsClass=r.call(arguments)==P;l.argsObject=arguments.constructor==Object&&!(arguments instanceof Array);l.enumErrorProps=Z.call(ia,"message")||Z.call(ia,"name");l.enumPrototypes=Z.call(a,"prototype");l.funcDecomp=!E(ma.WinRTError)&&ra.test(function(){return this});l.funcNames=typeof Function.name=="string";l.nonEnumArgs=0!=c;l.nonEnumShadows=!/valueOf/.test(d);l.ownLast="x"!=d[0];l.spliceObjects=(na.splice.call(b,0,1),!b[0]);l.unindexedChars="xx"!="x"[0]+Object("x")[0];try{l.nodeClass=!(r.call(document)==A&&!({toString:0}+""))}catch(e){l.nodeClass=true}})(1);X||(ba=function(){function a(){}return function(b){if(B(b)){a.prototype=b;var d=new a;a.prototype=null}return d||ma.Object()}}());var ca=Da?function(a,b){Ca.value=b;Da(a,"__bindData__",Ca)}:Aa;l.argsClass||(z=function(a){return a&&typeof a=="object"&&typeof a.length=="number"&&q.call(a,"callee")&&!Z.call(a,"callee")||false});var G=J||function(a){return a&&typeof a=="object"&&typeof a.length=="number"&&r.call(a)==Q||false},Ea=S({a:"z",e:"[]",i:"if(!(B[typeof z]))return E",g:"E.push(n)"}),aa=$?function(a){return B(a)?l.enumPrototypes&&typeof a=="function"||l.nonEnumArgs&&a.length&&z(a)?Ea(a):$(a):[]}:Ea,t={a:"g,e,K",i:"e=e&&typeof K=='undefined'?e:d(e,K,3)",b:"typeof u=='number'",v:aa,g:"if(e(t[n],n,g)===false)return E"},J={a:"z,H,l",i:"var a=arguments,b=0,c=typeof l=='number'?2:a.length;while(++b<c){t=a[b];if(t&&B[typeof t]){",v:aa,g:"if(typeof E[n]=='undefined')E[n]=t[n]",c:"}}"},Fa={i:"if(!B[typeof t])return E;"+t.i,b:false},ea=S(t),da=S(J,{i:J.i.replace(";",";if(c>3&&typeof a[c-2]=='function'){var e=d(a[--c-1],a[c--],2)}else if(c>2&&typeof a[c-1]=='function'){e=a[--c]}"),g:"E[n]=e?e(E[n],t[n]):t[n]"}),R=S(t,Fa,{j:false}),pa=S(t,Fa);D(/x/)&&(D=function(a){return typeof a=="function"&&"[object Function]"==r.call(a)});t=I?function(a){if(!a||r.call(a)!=A||!l.argsClass&&z(a))return false;var b=a.valueOf,d=E(b)&&(d=I(b))&&I(d);return d?a==d||I(a)==d:xa(a)}:xa;e.assign=da;e.bind=sa;e.createCallback=function(a,b,d){var c=typeof a;if(null==a||"function"==c)return fa(a,b,d);if("object"!=c)return Ba(a);var e=aa(a),g=e[0],h=a[g];return 1!=e.length||h!==h||B(h)?function(b){for(var c=e.length,d=false;c--&&(d=O(b[e[c]],a[e[c]],null,true)););return d}:function(a){a=a[g];return h===a&&(0!==h||1/h==1/a)}};e.flatten=function(a,b,d,c){typeof b!="boolean"&&null!=b&&(c=d,d=typeof b!="function"&&c&&c[b]===a?null:b,b=false);null!=d&&(a=ja(a,d,c));return ua(a,b)};e.forEach=ya;e.forIn=R;e.forOwn=pa;e.keys=aa;e.map=ja;e.property=Ba;e.rest=la;e.collect=ja;e.drop=la;e.each=ya;e.extend=da;e.tail=la;e.cloneDeep=function(a,b,d){return oa(a,true,typeof b=="function"&&fa(b,d,1))};e.has=function(a,b){return a?q.call(a,b):false};e.identity=qa;e.isArguments=z;e.isArray=G;e.isFunction=D;e.isNull=function(a){return null===a};e.isObject=B;e.isPlainObject=t;e.isString=wa;e.isUndefined=function(a){return typeof a=="undefined"};e.noop=Aa;e.first=ka;e.take=ka;e.head=ka;e.VERSION="2.4.1";_=e})();var globalPlugins={};keylime.registerPlugin=registerPlugin;keylime.unregisterPlugin=unregisterPlugin;keylime.plugins=plugins;function keylime(name){var constructor;if(!_.isString(name)){throw new Error("You must supply a 'name' parameter to the Keylime function")}constructor=eval("function "+name+"(){var topArgs = arguments; var OriginalClass = "+name+"; var create"+name+" = function create"+name+"() { function "+name+"() { return OriginalClass.apply(this, topArgs); }; "+name+".prototype = OriginalClass.prototype; return new "+name+"(); }; if (!(this instanceof "+name+")) { return create"+name+"(); }; if (!this._model) {Object.defineProperties(this, {_model: {value: "+name+"}});}Object.getPrototypeOf("+name+".prototype).constructor.apply(this, arguments);};"+name);constructor._parent={constructor:null};constructor._blueprint={};constructor._lastAttr=null;constructor._initHandlers=[];constructor._attrInitHandlers=[];constructor.attr=attr.bind(constructor);constructor.attrs=attrs.bind(constructor);constructor.inherits=constructor.inherit=inherits.bind(constructor);constructor.use=use.bind(constructor);constructor.method=method.bind(constructor);constructor.classMethod=classMethod.bind(constructor);constructor.attrHelper=attrHelper.bind(constructor);constructor.classHelper=classHelper.bind(constructor);constructor.init=init.bind(constructor);constructor.attrInit=attrInit.bind(constructor);constructor.create=create.bind(constructor);constructor.prototype.__proto__=KeylimeModel.prototype;return constructor}function attr(name,value){if(!_.isString(name)){throw new Error("You must supply a 'name' argument to create an attribute on "+this.name+".")}if(_.isUndefined(value)){value=null}else if(_.isArray(value)||_.isPlainObject(value)){value=_.cloneDeep(value)}this._blueprint[name]={value:value};this._lastAttr=name;return this}function inherits(constructor){if(!_.isFunction(constructor)){throw new Error("You must supply a 'constructor' function argument to add inheritance on "+this.name+".")}if(!_isKeylimeConstructor(constructor)){throw new Error("You must supply another Keylime constructor to add inheritance on "+this.name+".")}this.prototype.__proto__=constructor.prototype;this._parent.constructor=constructor;return this}function KeylimeModel(values){recursiveApplyBlueprint.call(this,this._model,values);recursiveCallHandlers.apply(this,_.flatten([this._model,arguments]))}function recursiveCallHandlers(){var constructor=_.first(arguments),args=_.rest(arguments,1);if(!_.isNull(constructor._parent.constructor)){recursiveCallHandlers.apply(this,_.flatten([constructor._parent.constructor,args]))}if(constructor._attrInitHandlers.length>0){_.forIn(constructor._blueprint,function(attr,name){_.each(constructor._attrInitHandlers,function(handler){handler.call(this,name,this[name],attr)},this)},this)}_.each(constructor._initHandlers,function(handler){handler.apply(this,args)},this)}function recursiveApplyBlueprint(constructor,values){if(!_.isNull(constructor._parent.constructor)){recursiveApplyBlueprint.call(this,constructor._parent.constructor,values)}_.forIn(constructor._blueprint,function(attr,key){var value=_.has(values,key)?values[key]:attr.value;if(_.isArray(value)||_.isPlainObject(value)){this[key]=_.cloneDeep(value)}else if(_.isFunction(value)){this[key]=value()}else{this[key]=value}},this)}function use(){var plugin=_.first(arguments),args=_.rest(arguments),pluginFunc;if(!_.isFunction(plugin)&&!_.isString(plugin)){throw new Error("You must supply a function or a 'name' to call 'use' on "+this.name+".")}if(_.isFunction(plugin)){pluginFunc=plugin}if(_.isString(plugin)){if(!_.has(globalPlugins,plugin)){throw new Error("No valid plugin found for with the name '"+plugin+"'! Check that keylime.plugins('"+plugin+"') exists.")}pluginFunc=globalPlugins[plugin]}pluginFunc.apply(pluginFunc,_.flatten([this,args]));return this}function create(){return this.apply(null,arguments)}function method(name,func){if(!_.isString(name)){throw new Error("You must supply a 'name' argument to add a method on "+this.name+".")}if(!_.isFunction(func)){throw new Error("You must supply a function argument to add a method on "+this.name+".")}this.prototype[name]=func;return this}function classMethod(name,func){if(!_.isString(name)){throw new Error("You must supply a 'name' argument to add a class method on "+this.name+".")}if(!_.isFunction(func)){throw new Error("You must supply a function argument to add a class method on "+this.name+".")}this[name]=func;return this}function attrHelper(name,func){if(!_.isString(name)){throw new Error("You must supply a 'name' argument to add an attribute helper on "+this.name+".")}if(!_.isFunction(func)){throw new Error("You must supply a function argument to add an attribute helper on "+this.name+".")}this[name]=function attrHelperProduct(){var lastAttribute;if(_.isNull(this._lastAttr)){throw new Error("You must add an attribute on "+this.name+" before you can use the "+name+" helper.")}lastAttribute=this._blueprint[this._lastAttr];func.apply(this,_.flatten([lastAttribute,[].slice.call(arguments)]));return this}.bind(this);return this}function classHelper(name,func){if(!_.isString(name)){throw new Error("You must supply a 'name' argument to add a class helper on "+this.name+".")}if(!_.isFunction(func)){throw new Error("You must supply a function argument to add a class helper on "+this.name+".")}this[name]=function classHelperProduct(){func.apply(this,arguments);return this}.bind(this);return this}function attrs(name){if(_.isString(name)){return this._blueprint[name]}return this._blueprint}function init(handler){if(!_.isFunction(handler)){throw new Error("You must supply a function to add an initialization handler on "+this.name+".")}this._initHandlers.push(handler);return this}function attrInit(handler){if(!_.isFunction(handler)){throw new Error("You must supply a function to add an attribute initialization handler on "+this.name+".")}this._attrInitHandlers.push(handler);return this}function registerPlugin(name,plugin){if(!_.isString(name)){throw new Error("You must supply a 'name' parameter to register a plugin globally on Keylime.")}if(!_.isFunction(plugin)){throw new Error("You must supply a function to register a plugin globally on Keylime.")}globalPlugins[name]=plugin;return plugin}function unregisterPlugin(name){var plugin;if(!_.isString(name)){throw new Error("You must supply a name to de-register a plugin globally on Keylime.")}if(!_.isFunction(globalPlugins[name])){return false}plugin=globalPlugins[name];globalPlugins[name]=null;delete globalPlugins[name];return plugin}function plugins(name){var globals=_.cloneDeep(globalPlugins);if(_.isString(name)){return globals[name]}else{return globals}}function _isKeylimeConstructor(constructor){if(!_.isFunction(constructor)){return false}if(!_.isPlainObject(constructor._blueprint)){return false}return true}(function(root,factory){if(typeof define==="function"&&define.amd){define([],factory)}else{root.keylime=factory()}})(this,function(){return keylime})})();